object fMain: TfMain
  Left = 0
  Top = 0
  Margins.Left = 10
  Caption = 'TaskBook'
  ClientHeight = 468
  ClientWidth = 650
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -12
  Font.Name = 'Segoe UI'
  Font.Style = []
  Position = poDesktopCenter
  OnClose = FormClose
  OnCreate = FormCreate
  OnShow = FormShow
  TextHeight = 15
  object pnlGrid: TPanel
    Left = 105
    Top = 0
    Width = 545
    Height = 468
    Align = alClient
    BevelOuter = bvNone
    TabOrder = 0
    object rzclcksts1: TRzClockStatus
      AlignWithMargins = True
      Left = 3
      Top = 301
      Width = 539
      Align = alBottom
      ExplicitLeft = 80
      ExplicitTop = 412
      ExplicitWidth = 150
    end
    object dbgrdDays: TDBGrid
      AlignWithMargins = True
      Left = 3
      Top = 3
      Width = 334
      Height = 292
      Align = alLeft
      DataSource = dsDays
      Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit, dgTitleClick, dgTitleHotTrack]
      TabOrder = 0
      TitleFont.Charset = DEFAULT_CHARSET
      TitleFont.Color = clWindowText
      TitleFont.Height = -12
      TitleFont.Name = 'Segoe UI'
      TitleFont.Style = []
      OnDblClick = dbgrdDaysDblClick
    end
    object pnlInput: TPanel
      Left = 0
      Top = 324
      Width = 545
      Height = 144
      Align = alBottom
      TabOrder = 1
      object lblDescriptions: TLabel
        Left = 1
        Top = 1
        Width = 543
        Height = 15
        Align = alTop
        Caption = 'descriptions'
        FocusControl = dbmmodescriptions
        ExplicitWidth = 64
      end
      object dbmmodescriptions: TDBMemo
        AlignWithMargins = True
        Left = 11
        Top = 19
        Width = 523
        Height = 73
        Margins.Left = 10
        Margins.Right = 10
        Margins.Bottom = 10
        Align = alClient
        DataField = 'descriptions'
        DataSource = dsDays
        TabOrder = 0
        OnDblClick = dbmmodescriptionsDblClick
      end
      object pnlbtns: TPanel
        Left = 1
        Top = 102
        Width = 543
        Height = 41
        Align = alBottom
        TabOrder = 1
        object grdpnl1: TGridPanel
          Left = 1
          Top = 1
          Width = 541
          Height = 39
          Align = alClient
          ColumnCollection = <
            item
              Value = 33.382182211859500000
            end
            item
              Value = 33.447896208139110000
            end
            item
              Value = 33.169921580001390000
            end>
          ControlCollection = <
            item
              Column = 0
              Control = btnEdit
              Row = 0
            end
            item
              Column = 1
              Control = btnCancel
              Row = 0
            end
            item
              Column = 2
              Control = btnPost
              Row = 0
            end>
          RowCollection = <
            item
              Value = 100.000000000000000000
            end>
          TabOrder = 0
          object btnEdit: TButton
            AlignWithMargins = True
            Left = 4
            Top = 4
            Width = 174
            Height = 31
            Action = dtstdt
            Align = alClient
            TabOrder = 0
          end
          object btnCancel: TButton
            AlignWithMargins = True
            Left = 184
            Top = 4
            Width = 174
            Height = 31
            Action = dtstcncl
            Align = alClient
            TabOrder = 1
          end
          object btnPost: TButton
            AlignWithMargins = True
            Left = 364
            Top = 4
            Width = 173
            Height = 31
            Action = dtstpst
            Align = alClient
            TabOrder = 2
          end
        end
      end
    end
    object grpTimeSheet: TGroupBox
      Left = 340
      Top = 0
      Width = 205
      Height = 298
      Align = alClient
      Caption = 'Time Sheet'
      TabOrder = 2
      object dbgrdTimeSheet: TDBGrid
        Left = 2
        Top = 17
        Width = 201
        Height = 133
        Align = alClient
        DataSource = dsTimeSheet
        Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit, dgTitleClick, dgTitleHotTrack]
        TabOrder = 0
        TitleFont.Charset = DEFAULT_CHARSET
        TitleFont.Color = clWindowText
        TitleFont.Height = -12
        TitleFont.Name = 'Segoe UI'
        TitleFont.Style = []
      end
      object grpDescriptions: TGroupBox
        Left = 2
        Top = 150
        Width = 201
        Height = 105
        Align = alBottom
        Caption = 'discriptions'
        TabOrder = 1
        object dbmmoTimeSheetDescriptions: TDBMemo
          AlignWithMargins = True
          Left = 5
          Top = 20
          Width = 191
          Height = 80
          Align = alClient
          DataField = 'descriptions'
          DataSource = dsTimeSheet
          TabOrder = 0
        end
      end
      object pnlbtnstimesheet: TPanel
        Left = 2
        Top = 255
        Width = 201
        Height = 41
        Align = alBottom
        TabOrder = 2
        object grdpnl11: TGridPanel
          Left = 1
          Top = 1
          Width = 199
          Height = 39
          Align = alClient
          ColumnCollection = <
            item
              Value = 25.813715866457340000
            end
            item
              Value = 24.952284611707650000
            end
            item
              Value = 24.501663670016380000
            end
            item
              Value = 24.732335851818630000
            end>
          ControlCollection = <
            item
              Column = 0
              Control = btnTimeSheetEdit
              Row = 0
            end
            item
              Column = 1
              Control = btnTimeSheetCancel
              Row = 0
            end
            item
              Column = 3
              Control = btnTimeSheetPost
              Row = 0
            end
            item
              Column = 2
              Control = btnDeleteTimeSheet
              Row = 0
            end>
          RowCollection = <
            item
              Value = 100.000000000000000000
            end>
          TabOrder = 0
          object btnTimeSheetEdit: TButton
            AlignWithMargins = True
            Left = 4
            Top = 4
            Width = 45
            Height = 31
            Action = actEditTimeSheet
            Align = alClient
            TabOrder = 0
          end
          object btnTimeSheetCancel: TButton
            AlignWithMargins = True
            Left = 55
            Top = 4
            Width = 43
            Height = 31
            Action = actCancelTimeSheet
            Align = alClient
            TabOrder = 1
          end
          object btnTimeSheetPost: TButton
            AlignWithMargins = True
            Left = 152
            Top = 4
            Width = 43
            Height = 31
            Action = actPostTimeSheet
            Align = alClient
            TabOrder = 2
          end
          object btnDeleteTimeSheet: TButton
            AlignWithMargins = True
            Left = 104
            Top = 4
            Width = 42
            Height = 31
            Hint = 'Delete'
            Align = alClient
            Caption = '&Delete'
            ImageIndex = 5
            TabOrder = 3
            OnClick = btnDeleteTimeSheetClick
          end
        end
      end
    end
  end
  object pnlControls: TPanel
    Left = 0
    Top = 0
    Width = 105
    Height = 468
    Align = alLeft
    BevelOuter = bvNone
    TabOrder = 1
    object GridPanel1: TGridPanel
      Left = 0
      Top = 0
      Width = 105
      Height = 468
      Align = alClient
      ColumnCollection = <
        item
          Value = 100.000000000000000000
        end>
      ControlCollection = <
        item
          Column = 0
          Control = btnAdd
          Row = 0
        end
        item
          Column = 0
          Control = btnExit
          Row = 5
        end
        item
          Column = 0
          Control = btnShowDay
          Row = 2
        end
        item
          Column = 0
          Control = btnFinish
          Row = 1
        end
        item
          Column = 0
          Control = btnSetTimesheetIn
          Row = 3
        end
        item
          Column = 0
          Control = btnTimeSheetOut
          Row = 4
        end>
      RowCollection = <
        item
          Value = 16.034112942870250000
        end
        item
          Value = 16.087587839511020000
        end
        item
          Value = 16.325124379763310000
        end
        item
          Value = 16.710697176483140000
        end
        item
          Value = 17.184843664778710000
        end
        item
          Value = 17.657633996593580000
        end>
      TabOrder = 0
      object btnAdd: TButton
        AlignWithMargins = True
        Left = 6
        Top = 6
        Width = 93
        Height = 65
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'Add Today'
        TabOrder = 0
        OnClick = btnAddClick
      end
      object btnExit: TButton
        AlignWithMargins = True
        Left = 6
        Top = 390
        Width = 93
        Height = 72
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'Exit'
        TabOrder = 1
        OnClick = btnExitClick
      end
      object btnShowDay: TButton
        AlignWithMargins = True
        Left = 6
        Top = 156
        Width = 93
        Height = 66
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'Show'
        TabOrder = 2
        OnClick = dbgrdDaysDblClick
      end
      object btnFinish: TButton
        AlignWithMargins = True
        Left = 6
        Top = 81
        Width = 93
        Height = 65
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'Finish Today'
        TabOrder = 3
        OnClick = btnFinishClick
      end
      object btnSetTimesheetIn: TButton
        AlignWithMargins = True
        Left = 6
        Top = 232
        Width = 93
        Height = 68
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'In'
        TabOrder = 4
        OnClick = btnSetTimesheetInClick
      end
      object btnTimeSheetOut: TButton
        AlignWithMargins = True
        Left = 6
        Top = 310
        Width = 93
        Height = 70
        Margins.Left = 5
        Margins.Top = 5
        Margins.Right = 5
        Margins.Bottom = 5
        Align = alClient
        Caption = 'Out'
        TabOrder = 5
        OnClick = btnTimeSheetOutClick
      end
    end
  end
  object qryDays: TADOQuery
    Connection = DataModule1.MainConnection
    CursorType = ctStatic
    AfterScroll = qryDaysAfterScroll
    Parameters = <>
    SQL.Strings = (
      'SELECT '
      '    id,'
      '    td.person_id,'
      '    FORMAT(td.working_date, '#39'dddd'#39', '#39'fa-IR'#39') AS day_name,'
      '    FORMAT(td.working_date, '#39'yyyy/MM/dd'#39', '#39'fa'#39') AS working_date,'
      '    FORMAT(td.started_at, '#39'HH:mm:ss'#39', '#39'fa'#39') AS started_at,'
      '    FORMAT(td.finished_at, '#39'HH:mm:ss'#39', '#39'fa'#39') AS finished_at,'
      '    td.descriptions,'
      '    CASE '
      
        '        WHEN td.started_at IS NULL OR td.finished_at IS NULL THE' +
        'N '#39'00:00'#39
      
        '        WHEN DATEDIFF(MINUTE, td.started_at, td.finished_at) > 7' +
        '20 THEN '#39'00:00'#39
      
        '        ELSE RIGHT('#39'0'#39' + CAST(DATEDIFF(MINUTE, td.started_at, td' +
        '.finished_at) / 60 AS VARCHAR), 2) + '#39':'#39' +'
      
        '             RIGHT('#39'0'#39' + CAST(DATEDIFF(MINUTE, td.started_at, td' +
        '.finished_at) % 60 AS VARCHAR), 2)'
      '    END AS diff_in_time'
      'FROM '
      '    tblDays AS td'
      'WHERE '
      '    td.person_id = 1;')
    Left = 256
    Top = 352
    object qryDaysid: TAutoIncField
      FieldName = 'id'
      ReadOnly = True
      Visible = False
    end
    object qryDaysworking_date: TWideStringField
      DisplayLabel = 'Date'
      DisplayWidth = 12
      FieldName = 'working_date'
      ReadOnly = True
      Size = 4000
    end
    object qryDaysday_name: TWideStringField
      DisplayLabel = 'Day'
      DisplayWidth = 8
      FieldName = 'day_name'
      ReadOnly = True
      Size = 4000
    end
    object qryDays_person_id: TIntegerField
      FieldName = 'person_id'
      Visible = False
    end
    object qryDaysstarted_at: TWideStringField
      DisplayLabel = 'Start Time'
      DisplayWidth = 10
      FieldName = 'started_at'
      ReadOnly = True
      Size = 4000
    end
    object qryDaysfinished_at: TWideStringField
      DisplayLabel = 'Finish Time'
      DisplayWidth = 10
      FieldName = 'finished_at'
      ReadOnly = True
      Size = 4000
    end
    object qryDaysdescriptions: TWideMemoField
      FieldName = 'descriptions'
      Visible = False
      BlobType = ftWideMemo
    end
  end
  object dsDays: TDataSource
    DataSet = qryDays
    OnStateChange = dsDaysStateChange
    Left = 313
    Top = 352
  end
  object actmgr1: TActionManager
    Left = 384
    Top = 352
    StyleName = 'Platform Default'
    object actEditTimeSheet: TDataSetEdit
      Category = 'Dataset'
      Caption = '&Edit'
      Hint = 'Edit'
      ImageIndex = 6
      DataSource = dsTimeSheet
    end
    object actPostTimeSheet: TDataSetPost
      Category = 'Dataset'
      Caption = 'P&ost'
      Hint = 'Post'
      ImageIndex = 7
      DataSource = dsTimeSheet
    end
    object actCancelTimeSheet: TDataSetCancel
      Category = 'Dataset'
      Caption = '&Cancel'
      Hint = 'Cancel'
      ImageIndex = 8
      DataSource = dsTimeSheet
    end
    object act: TAction
      Caption = 'act'
    end
    object dtstdt: TDataSetEdit
      Category = 'Dataset'
      Caption = '&Edit'
      Hint = 'Edit'
      ImageIndex = 6
      DataSource = dsDays
    end
    object dtstpst: TDataSetPost
      Category = 'Dataset'
      Caption = 'P&ost'
      Hint = 'Post'
      ImageIndex = 7
      DataSource = dsDays
    end
    object dtstcncl: TDataSetCancel
      Category = 'Dataset'
      Caption = '&Cancel'
      Hint = 'Cancel'
      ImageIndex = 8
      DataSource = dsDays
    end
    object actDeleteTimeSheet: TDataSetDelete
      Category = 'Dataset'
      Caption = '&Delete'
      Hint = 'Delete'
      ImageIndex = 5
      DataSource = dsTimeSheet
    end
  end
  object qryTimeSheet: TADOQuery
    Connection = DataModule1.MainConnection
    CursorType = ctStatic
    AfterScroll = qryTimeSheetAfterScroll
    AfterRefresh = qryTimeSheetAfterScroll
    Parameters = <
      item
        Name = 'day_id'
        Attributes = [paSigned, paNullable]
        DataType = ftInteger
        Precision = 10
        Size = 4
        Value = Null
      end>
    SQL.Strings = (
      'SELECT id,'
      '       day_id,'
      '       FORMAT(in_time, '#39'HH:mm:ss'#39', '#39'en'#39') AS in_time,'
      '       FORMAT(out_time, '#39'HH:mm:ss'#39', '#39'en'#39') AS out_time,'
      '       descriptions'
      'FROM   tbltimesheet'
      'WHERE Day_id=:day_id')
    Left = 501
    Top = 96
    object qryTimeSheetid: TAutoIncField
      FieldName = 'id'
      ReadOnly = True
      Visible = False
    end
    object qryTimeSheetday_id: TIntegerField
      FieldName = 'day_id'
      Visible = False
    end
    object qryTimeSheetin_time: TWideStringField
      DisplayLabel = 'IN'
      DisplayWidth = 10
      FieldName = 'in_time'
      ReadOnly = True
      Size = 4000
    end
    object qryTimeSheetout_time: TWideStringField
      DisplayLabel = 'OUT'
      DisplayWidth = 10
      FieldName = 'out_time'
      ReadOnly = True
      Size = 4000
    end
    object qryTimeSheetdescriptions: TWideMemoField
      FieldName = 'descriptions'
      Visible = False
      BlobType = ftWideMemo
    end
  end
  object dsTimeSheet: TDataSource
    DataSet = qryTimeSheet
    OnStateChange = dsTimeSheetStateChange
    Left = 581
    Top = 96
  end
end
